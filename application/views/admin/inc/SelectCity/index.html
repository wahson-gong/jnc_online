<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>城市选择器</title>
<link href="application/views/admin/inc/SelectCity/zyzn_1.css" type="text/css" rel="stylesheet">
<script src="application/views/admin/js/jquery.js"></script>
<script type="text/javascript" src="application/views/admin/inc/SelectCity/City_data.js"></script>
<script type="text/javascript" src="application/views/admin/inc/SelectCity/areadata.js"></script>
</head>

<body>
<!-- 城市多选：<input type="text" class="" value="" data-value=""  onclick="appendCity(this,'duoxuan')" />
城市单选：<input type="text" class="" value="" data-value=""  onclick="appendCity(this,'danxuan')" /> -->

<script>
var type = "<?php echo $_GET["type"] ?>";
//获取父框架的元素 
var parent_field = parent.$('#temp_<?php echo $_GET['field']?>') ;
appendCity(parent_field,type);

//并关闭当前页面 ---》ghy
function close_layer()
{
	var index = parent.layer.getFrameIndex(window.name); //获取窗口索引
	parent.layer.close(index);
}





//确定选择
function svae_City() {

	//插件变量 
	var dataCityinput = null;
	dataCityinput= parent.$('#<?php echo $_GET['field']?>') ;
	//自定义显示
	var city_a_field = null;
	city_a_field= parent.$('#city_a_<?php echo $_GET['field']?>') ;
	
	console.log(dataCityinput.data("value"));
    var val = '';
    var Cityname = '';
    if ($('.svae_box').length > 0) {
        $('.svae_box').each(function() {
            val += $(this).data("code") + '-';
            Cityname += $(this).data("name") + '-';
        })
    }
    if (val != '') {
        val = val.substring(0, val.lastIndexOf('-'));
    }
    if (Cityname != '') {
        Cityname = Cityname.substring(0, Cityname.lastIndexOf('-'));
    }
	//修改数据表的值
    $(dataCityinput).attr("value",val+"|"+Cityname);
	//修改插件的值
	$(parent_field).attr("data-value", val);
    $(parent_field).attr("value", Cityname);
    //自定义显示
    $(city_a_field).html(Cityname);
    console.log(dataCityinput.data("value"));
    
    Close();
    close_layer();
}
function Close() {
    $('.aui_state_box').remove();
    close_layer();
}


</script>

</body>
</html>
